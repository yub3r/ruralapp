{% extends 'base.html' %}

{% block content %}
<h1 class="display-6 text-center">Historial de sorteos</h1>
<div class="text-center py-4"><a class="btn btn-info" href="{% url 'sorteo' %}">
    <i class="bi bi-tornado"></i> Nuevo Sorteo </a></div>

    <div class="table-container-sorteo">
        <table class="table table-borderless table-sm table table-striped">
        <thead>
            <tr>
                <th>Título del sorteo</th>
                <th>Fecha</th>
                <th>Ganadores</th>
                {% if 'auth.admin_group' in perms %}
                <th scope="col" style="text-align:right;">Repetir/Eliminar</th>
                {% else %}
                <th scope="col" style="text-align:right;">Repetir</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for sorteo in historial %}
            <tr>
                <td style="vertical-align: middle;">{{ sorteo.sorteo.titulo }}</td>
                <td style="vertical-align: middle;">{{ sorteo.sorteo.fecha|date:'j M H:i' }}</td>
                <td style="vertical-align: middle;">
                    {% for ganador in sorteo.ganadores %}
                        {{ ganador }}
                        {% if not forloop.last %} - {% endif %}
                    {% endfor %}
                    <td style="vertical-align: middle;">
                        <div style="float: right;">
                        <a href="{% url 'repetir_sorteo' sorteo.sorteo.id %}" class="btn btn-info"><i class="bi bi-tornado"></i></a>
                    
                        {% if 'auth.admin_group' in perms %}
                        <a class="btn btn-danger" href="{% url 'eliminar_sorteo' sorteo.sorteo.id %}"
                        onclick="return confirm('¿Estás seguro de que deseas eliminar este sorteo?');"><i
                            class="bi bi-trash3"></i></a></td>
                        {% endif %}
                        </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3">No hay sorteos registrados</td>
            </tr>
            {% endfor %}
    
            
        </tbody>
    </table>
</div>
{% endblock %}